(window.webpackJsonp=window.webpackJsonp||[]).push([[3],[,,function(t,e,r){"use strict";var n=r(18);r.d(e,"f",function(){return n.b});var o=r(42);r.d(e,"c",function(){return o.a});var i=r(55);r.d(e,"d",function(){return i.a});var s=r(273);r.d(e,"j",function(){return s.a});var u=r(274);r.d(e,"l",function(){return u.a});var a=r(275);r.d(e,"o",function(){return a.a});r(155),r(80),r(92);var c=r(276);r.d(e,"a",function(){return c.a});r(122),r(277);var h=r(123);r.d(e,"q",function(){return h.a});r(278);var d=r(124);r.d(e,"r",function(){return d.a});r(279);var f=r(154);r.d(e,"z",function(){return f.a});r(125),r(280);var p=r(281);r.d(e,"m",function(){return p.a});r(110),r(93),r(282);var l=r(283);r.d(e,"n",function(){return l.a});var v=r(94);r.d(e,"E",function(){return v.a});var y=r(284);r.d(e,"F",function(){return y.a});r(106),r(285);var E=r(57);r.d(e,"b",function(){return E.a});var A=r(78);r.d(e,"G",function(){return A.b});var m=r(56);r.d(e,"H",function(){return m.a});r(286);var g=r(287);r.d(e,"i",function(){return g.a});var R=r(288);r.d(e,"g",function(){return R.a});r(157);var I=r(79);r.d(e,"h",function(){return I.a});var T=r(29);r.d(e,"p",function(){return T.a});var w=r(33);r.d(e,"s",function(){return w.a});r(11);var _=r(289);r.d(e,"t",function(){return _.a});var N=r(158);r.d(e,"u",function(){return N.a});var O=r(290);r.d(e,"x",function(){return O.a});var b=r(159);r.d(e,"y",function(){return b.a});r(22);var P=r(20);r.d(e,"D",function(){return P.a});r(291);var U=r(292);r.d(e,"e",function(){return U.a});var S=r(156);r.d(e,"k",function(){return S.a});r(95),r(160);var D=r(293);r.d(e,"v",function(){return D.a});var C=r(294);r.d(e,"w",function(){return C.a});var k=r(16);r.d(e,"A",function(){return k.a});var L=r(14);r.d(e,"B",function(){return L.a});var F=r(27);r.d(e,"C",function(){return F.a});r(32),r(25),r(35),r(28),r(153)},,,,,,,,,function(t,e,r){"use strict";var n;!function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t.HEAD="HEAD",t.OPTIONS="OPTIONS",t.TRACE="TRACE",t.PATCH="PATCH"}(n||(n={})),e.a=n},,,function(t,e,r){"use strict";var n,o;r.d(e,"a",function(){return o}),r.d(e,"b",function(){return i}),function(t){t[t.LoggedOutDuringRequest=0]="LoggedOutDuringRequest",t[t.MustAuthenticateFirst=1]="MustAuthenticateFirst",t[t.UserNoLongerValid=2]="UserNoLongerValid",t[t.UserNotFound=3]="UserNotFound",t[t.UserNotLoggedIn=4]="UserNotLoggedIn",t[t.CouldNotLoadPersistedAuthInfo=5]="CouldNotLoadPersistedAuthInfo",t[t.CouldNotPersistAuthInfo=6]="CouldNotPersistAuthInfo",t[t.StreamingNotSupported=7]="StreamingNotSupported",t[t.StreamClosed=8]="StreamClosed",t[t.UnexpectedArguments=9]="UnexpectedArguments"}(o||(o={}));var i=((n={})[o.LoggedOutDuringRequest]="logged out while making a request to Stitch",n[o.MustAuthenticateFirst]="method called requires being authenticated",n[o.UserNoLongerValid]="user instance being accessed is no longer valid; please get a new user with auth.getUser()",n[o.UserNotFound]="user not found in list of users",n[o.UserNotLoggedIn]="cannot make the active user a logged out user; please use loginWithCredential() to switch to this user",n[o.CouldNotLoadPersistedAuthInfo]="failed to load stored auth information for Stitch",n[o.CouldNotPersistAuthInfo]="failed to save auth information for Stitch",n[o.StreamingNotSupported]="streaming not supported in this SDK",n[o.StreamClosed]="stream is closed",n[o.UnexpectedArguments]="function does not accept arguments",n)},,function(t,e,r){"use strict";var n,o=r(14),i=r(27),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e){var r=this,n="("+o.a[e]+"): "+o.b[e];return(r=t.call(this,n)||this).errorCode=e,r.errorCodeName=o.a[e],r}return s(e,t),e}(i.a);e.a=u},,,,function(t,e,r){"use strict";var n,o=r(18),i=r(35),s=r(28),u=r(29),a=function(){function t(e,r,a){this.eventName=e,r=r||"";for(var c=[],h=0;h<r.length;h++){var d=r[h];switch(d){case"%":if(h+2>=r.length)break;var f=void 0;switch(r.substring(h+1,h+3)){case"25":f=!0,c.push("%");break;case"0A":f=!0,c.push("\n");break;case"0D":f=!0,c.push("\r");break;default:f=!1}if(f){h+=2;continue}}c.push(d)}var p=c.join("");switch(this.eventName){case t.ERROR_EVENT_NAME:var l=void 0,v=void 0;try{var y=o.a.parse(p,{strict:!1});l=y[n.Error],v=Object(s.b)(y[n.ErrorCode])}catch(t){l=p,v=s.a.Unknown}this.error=new i.a(l,v);break;case u.a.MESSAGE_EVENT:this.data=o.a.parse(p,{strict:!1}),a&&(this.data=a.decode(this.data))}}return t.fromEvent=function(e,r){return new t(e.eventName,e.data,r)},t.ERROR_EVENT_NAME="error",t}();e.a=a,function(t){t.Error="error",t.ErrorCode="error_code"}(n||(n={}))},,function(t,e,r){"use strict";r.d(e,"a",function(){return s});var n,o=r(81),i=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r,n){void 0===r&&(r=!1),void 0===n&&(n=!0);var o=t.call(this,e.method,e.path,e.headers,e.startedAt,e.body)||this;return o.useRefreshToken=r,o.shouldRefreshOnFailure=n,o}return i(e,t),Object.defineProperty(e.prototype,"builder",{get:function(){return new e.Builder(this)},enumerable:!0,configurable:!0}),e}(o.a);!function(t){var e=function(e){function r(t){return e.call(this,t)||this}return i(r,e),r.prototype.withAccessToken=function(){return this.useRefreshToken=!1,this},r.prototype.withRefreshToken=function(){return this.useRefreshToken=!0,this},r.prototype.withShouldRefreshOnFailure=function(t){return this.shouldRefreshOnFailure=t,this},r.prototype.build=function(){return this.useRefreshToken&&(this.shouldRefreshOnFailure=!1),new t(e.prototype.build.call(this),this.useRefreshToken,this.shouldRefreshOnFailure)},r}(o.a.Builder);t.Builder=e}(s||(s={}))},,,function(t,e,r){"use strict";var n,o;r.d(e,"a",function(){return o}),r.d(e,"b",function(){return i}),function(t){t[t.TRANSPORT_ERROR=0]="TRANSPORT_ERROR",t[t.DECODING_ERROR=1]="DECODING_ERROR",t[t.ENCODING_ERROR=2]="ENCODING_ERROR"}(o||(o={}));var i=((n={})[o.TRANSPORT_ERROR]="the request transport encountered an error communicating with Stitch",n[o.DECODING_ERROR]="an error occurred while decoding a response from Stitch",n[o.ENCODING_ERROR]="an error occurred while encoding a request for Stitch",n)},,function(t,e,r){"use strict";var n,o=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=function(t){Error.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(this),this.message=t,this.name=this.constructor.name};i.prototype=Object.create(Error.prototype);var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);e.a=s},function(t,e,r){"use strict";var n;r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i}),function(t){t[t.MissingAuthReq=0]="MissingAuthReq",t[t.InvalidSession=1]="InvalidSession",t[t.UserAppDomainMismatch=2]="UserAppDomainMismatch",t[t.DomainNotAllowed=3]="DomainNotAllowed",t[t.ReadSizeLimitExceeded=4]="ReadSizeLimitExceeded",t[t.InvalidParameter=5]="InvalidParameter",t[t.MissingParameter=6]="MissingParameter",t[t.TwilioError=7]="TwilioError",t[t.GCMError=8]="GCMError",t[t.HTTPError=9]="HTTPError",t[t.AWSError=10]="AWSError",t[t.MongoDBError=11]="MongoDBError",t[t.ArgumentsNotAllowed=12]="ArgumentsNotAllowed",t[t.FunctionExecutionError=13]="FunctionExecutionError",t[t.NoMatchingRuleFound=14]="NoMatchingRuleFound",t[t.InternalServerError=15]="InternalServerError",t[t.AuthProviderNotFound=16]="AuthProviderNotFound",t[t.AuthProviderAlreadyExists=17]="AuthProviderAlreadyExists",t[t.ServiceNotFound=18]="ServiceNotFound",t[t.ServiceTypeNotFound=19]="ServiceTypeNotFound",t[t.ServiceAlreadyExists=20]="ServiceAlreadyExists",t[t.ServiceCommandNotFound=21]="ServiceCommandNotFound",t[t.ValueNotFound=22]="ValueNotFound",t[t.ValueAlreadyExists=23]="ValueAlreadyExists",t[t.ValueDuplicateName=24]="ValueDuplicateName",t[t.FunctionNotFound=25]="FunctionNotFound",t[t.FunctionAlreadyExists=26]="FunctionAlreadyExists",t[t.FunctionDuplicateName=27]="FunctionDuplicateName",t[t.FunctionSyntaxError=28]="FunctionSyntaxError",t[t.FunctionInvalid=29]="FunctionInvalid",t[t.IncomingWebhookNotFound=30]="IncomingWebhookNotFound",t[t.IncomingWebhookAlreadyExists=31]="IncomingWebhookAlreadyExists",t[t.IncomingWebhookDuplicateName=32]="IncomingWebhookDuplicateName",t[t.RuleNotFound=33]="RuleNotFound",t[t.ApiKeyNotFound=34]="ApiKeyNotFound",t[t.RuleAlreadyExists=35]="RuleAlreadyExists",t[t.RuleDuplicateName=36]="RuleDuplicateName",t[t.AuthProviderDuplicateName=37]="AuthProviderDuplicateName",t[t.RestrictedHost=38]="RestrictedHost",t[t.ApiKeyAlreadyExists=39]="ApiKeyAlreadyExists",t[t.IncomingWebhookAuthFailed=40]="IncomingWebhookAuthFailed",t[t.ExecutionTimeLimitExceeded=41]="ExecutionTimeLimitExceeded",t[t.FunctionNotCallable=42]="FunctionNotCallable",t[t.UserAlreadyConfirmed=43]="UserAlreadyConfirmed",t[t.UserNotFound=44]="UserNotFound",t[t.UserDisabled=45]="UserDisabled",t[t.Unknown=46]="Unknown"}(n||(n={}));var o={APIKeyAlreadyExists:n.ApiKeyAlreadyExists,APIKeyNotFound:n.ApiKeyNotFound,AWSError:n.AWSError,ArgumentsNotAllowed:n.ArgumentsNotAllowed,AuthProviderAlreadyExists:n.AuthProviderAlreadyExists,AuthProviderDuplicateName:n.AuthProviderDuplicateName,AuthProviderNotFound:n.AuthProviderNotFound,DomainNotAllowed:n.DomainNotAllowed,ExecutionTimeLimitExceeded:n.ExecutionTimeLimitExceeded,FunctionAlreadyExists:n.FunctionAlreadyExists,FunctionDuplicateName:n.FunctionDuplicateName,FunctionExecutionError:n.FunctionExecutionError,FunctionInvalid:n.FunctionInvalid,FunctionNotCallable:n.FunctionNotCallable,FunctionNotFound:n.FunctionNotFound,FunctionSyntaxError:n.FunctionSyntaxError,GCMError:n.GCMError,HTTPError:n.HTTPError,IncomingWebhookAlreadyExists:n.IncomingWebhookAlreadyExists,IncomingWebhookAuthFailed:n.IncomingWebhookAuthFailed,IncomingWebhookDuplicateName:n.IncomingWebhookDuplicateName,IncomingWebhookNotFound:n.IncomingWebhookNotFound,InternalServerError:n.InternalServerError,InvalidParameter:n.InvalidParameter,InvalidSession:n.InvalidSession,MissingAuthReq:n.MissingAuthReq,MissingParameter:n.MissingParameter,MongoDBError:n.MongoDBError,NoMatchingRuleFound:n.NoMatchingRuleFound,ReadSizeLimitExceeded:n.ReadSizeLimitExceeded,RestrictedHost:n.RestrictedHost,RuleAlreadyExists:n.RuleAlreadyExists,RuleDuplicateName:n.RuleDuplicateName,RuleNotFound:n.RuleNotFound,ServiceAlreadyExists:n.ServiceAlreadyExists,ServiceCommandNotFound:n.ServiceCommandNotFound,ServiceNotFound:n.ServiceNotFound,ServiceTypeNotFound:n.ServiceTypeNotFound,TwilioError:n.TwilioError,UserAlreadyConfirmed:n.UserAlreadyConfirmed,UserAppDomainMismatch:n.UserAppDomainMismatch,UserDisabled:n.UserDisabled,UserNotFound:n.UserNotFound,ValueAlreadyExists:n.ValueAlreadyExists,ValueDuplicateName:n.ValueDuplicateName,ValueNotFound:n.ValueNotFound};function i(t){return t in o?o[t]:n.Unknown}},function(t,e,r){"use strict";var n=function(){function t(t,e){this.eventName=t,this.data=e}return t.MESSAGE_EVENT="message",t}();e.a=n},,,function(t,e,r){"use strict";var n,o=r(27),i=r(25),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r){var n=this,o="("+i.a[r]+"): "+i.b[r]+": "+e.message;return(n=t.call(this,o)||this).underlyingError=e,n.errorCode=r,n.errorCodeName=i.a[r],n}return s(e,t),e}(o.a);e.a=u},function(t,e,r){"use strict";var n=function(){function t(){}return t.getAuthorizationBearer=function(e){return t.AUTHORIZATION_BEARER+" "+e},t.CONTENT_TYPE_CANON="Content-Type",t.CONTENT_TYPE=t.CONTENT_TYPE_CANON.toLocaleLowerCase(),t.AUTHORIZATION_CANON="Authorization",t.AUTHORIZATION=t.AUTHORIZATION_CANON.toLocaleLowerCase(),t.ACCEPT_CANON="Accept",t.ACCEPT=t.ACCEPT_CANON.toLocaleLowerCase(),t.AUTHORIZATION_BEARER="Bearer",t}();e.a=n},function(t,e,r){"use strict";var n=function(){return function(t){void 0===t&&(t=!1),this.reusesExistingSession=t}}();e.a=n},function(t,e,r){"use strict";var n,o=r(27),i=r(28),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r){void 0===r&&(r=i.a.Unknown);var n=t.call(this,e)||this;return n.message=e,n.errorCode=r,n.errorCodeName=i.a[r],n}return s(e,t),e}(o.a);e.a=u},,,,,,,function(t,e,r){"use strict";var n;r.d(e,"a",function(){return n}),function(t){t[t.ActiveUserChanged=0]="ActiveUserChanged",t[t.ListenerRegistered=1]="ListenerRegistered",t[t.UserAdded=2]="UserAdded",t[t.UserLinked=3]="UserLinked",t[t.UserLoggedIn=4]="UserLoggedIn",t[t.UserLoggedOut=5]="UserLoggedOut",t[t.UserRemoved=6]="UserRemoved"}(n||(n={}))},,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return d}),r.d(e,"b",function(){return f}),r.d(e,"c",function(){return p}),r.d(e,"d",function(){return l});var n,o,i=r(16),s=r(14),u=r(55),a=r(183),c=r(129),h=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function d(t){var e=t.get(v.ACTIVE_USER_STORAGE_NAME);if(e)return v.decode(JSON.parse(e))}function f(t){var e=t.get(v.ALL_USERS_STORAGE_NAME);if(!e)return new Map;var r=JSON.parse(e);if(!Array.isArray(r))throw new i.a(s.a.CouldNotLoadPersistedAuthInfo);var n=new Map;return r.forEach(function(t){var e=v.decode(t);n.set(e.userId,e)}),n}function p(t,e){if(t.isEmpty)e.remove(v.ACTIVE_USER_STORAGE_NAME);else{var r=new v(t.userId,t.deviceId,t.accessToken,t.refreshToken,t.loggedInProviderType,t.loggedInProviderName,t.lastAuthActivity,t.userProfile?new a.a(t.userProfile.userType,t.userProfile.data,t.userProfile.identities.map(function(t){return new c.a(t.id,t.providerType)})):void 0);e.set(v.ACTIVE_USER_STORAGE_NAME,JSON.stringify(r.encode()))}}function l(t,e){var r=[];t.forEach(function(t,e){var n=new v(e,t.deviceId,t.accessToken,t.refreshToken,t.loggedInProviderType,t.loggedInProviderName,t.lastAuthActivity,t.userProfile?new a.a(t.userProfile.userType,t.userProfile.data,t.userProfile.identities.map(function(t){return new c.a(t.id,t.providerType)})):void 0);r.push(n.encode())}),e.set(v.ALL_USERS_STORAGE_NAME,JSON.stringify(r))}!function(t){t.USER_ID="user_id",t.DEVICE_ID="device_id",t.ACCESS_TOKEN="access_token",t.REFRESH_TOKEN="refresh_token",t.LAST_AUTH_ACTIVITY="last_auth_activity",t.LOGGED_IN_PROVIDER_TYPE="logged_in_provider_type",t.LOGGED_IN_PROVIDER_NAME="logged_in_provider_name",t.USER_PROFILE="user_profile"}(o||(o={}));var v=function(t){function e(e,r,n,o,i,s,u,a){var c=t.call(this,e,r,n,o,i,s,u,a)||this;return c.userProfile=a,c}return h(e,t),e.decode=function(t){var r=t[o.USER_ID],n=t[o.DEVICE_ID],i=t[o.ACCESS_TOKEN],s=t[o.REFRESH_TOKEN],u=t[o.LOGGED_IN_PROVIDER_TYPE],c=t[o.LOGGED_IN_PROVIDER_NAME],h=t[o.USER_PROFILE],d=t[o.LAST_AUTH_ACTIVITY];return new e(r,n,i,s,u,c,new Date(d),a.a.decode(h))},e.prototype.encode=function(){var t={};return t[o.USER_ID]=this.userId,t[o.ACCESS_TOKEN]=this.accessToken,t[o.REFRESH_TOKEN]=this.refreshToken,t[o.DEVICE_ID]=this.deviceId,t[o.LOGGED_IN_PROVIDER_NAME]=this.loggedInProviderName,t[o.LOGGED_IN_PROVIDER_TYPE]=this.loggedInProviderType,t[o.LAST_AUTH_ACTIVITY]=this.lastAuthActivity?this.lastAuthActivity.getTime():void 0,t[o.USER_PROFILE]=this.userProfile?this.userProfile.encode():void 0,t},e.ACTIVE_USER_STORAGE_NAME="auth_info",e.ALL_USERS_STORAGE_NAME="all_auth_infos",e}(u.a)},,,,,function(t,e,r){"use strict";var n=function(){function t(t,e,r,n,o,i,s,u){this.userId=t,this.deviceId=e,this.accessToken=r,this.refreshToken=n,this.loggedInProviderType=o,this.loggedInProviderName=i,this.lastAuthActivity=s,this.userProfile=u}return t.empty=function(){return new t(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)},Object.defineProperty(t.prototype,"hasUser",{get:function(){return void 0!==this.userId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return void 0===this.deviceId},enumerable:!0,configurable:!0}),t.prototype.loggedOut=function(){return new t(this.userId,this.deviceId,void 0,void 0,this.loggedInProviderType,this.loggedInProviderName,new Date,this.userProfile)},t.prototype.withClearedUser=function(){return new t(void 0,this.deviceId,void 0,void 0,void 0,void 0,void 0,void 0)},t.prototype.withAuthProvider=function(e,r){return new t(this.userId,this.deviceId,this.accessToken,this.refreshToken,e,r,new Date,this.userProfile)},t.prototype.withNewAuthActivityTime=function(){return new t(this.userId,this.deviceId,this.accessToken,this.refreshToken,this.loggedInProviderType,this.loggedInProviderName,new Date,this.userProfile)},Object.defineProperty(t.prototype,"isLoggedIn",{get:function(){return void 0!==this.accessToken&&void 0!==this.refreshToken},enumerable:!0,configurable:!0}),t.prototype.merge=function(e){return new t(void 0===e.userId?this.userId:e.userId,void 0===e.deviceId?this.deviceId:e.deviceId,void 0===e.accessToken?this.accessToken:e.accessToken,void 0===e.refreshToken?this.refreshToken:e.refreshToken,void 0===e.loggedInProviderType?this.loggedInProviderType:e.loggedInProviderType,void 0===e.loggedInProviderName?this.loggedInProviderName:e.loggedInProviderName,void 0===e.lastAuthActivity?this.lastAuthActivity:e.lastAuthActivity,void 0===e.userProfile?this.userProfile:e.userProfile)},t}();e.a=n},function(t,e,r){"use strict";r.d(e,"b",function(){return d}),r.d(e,"a",function(){return f});var n,o=r(27),i=r(32),s=r(25),u=r(35),a=r(28),c=r(79),h=r(33);function d(t){return t instanceof o.a?t:new i.a(t,s.a.DECODING_ERROR)}function f(t){if(void 0===t.body)throw new u.a("received unexpected status code "+t.statusCode,a.a.Unknown);var e;try{e=t.body}catch(e){throw new u.a("received unexpected status code "+t.statusCode,a.a.Unknown)}var r=function(t,e){if(void 0===t.headers[h.a.CONTENT_TYPE]||void 0!==t.headers[h.a.CONTENT_TYPE]&&t.headers[h.a.CONTENT_TYPE]!==c.a.APPLICATION_JSON)return e;var r=JSON.parse(e);if(!(r instanceof Object))return e;var o=r;if(void 0===o[n.ERROR])return e;var i=o[n.ERROR];if(void 0===o[n.ERROR_CODE])return i;var s=o[n.ERROR_CODE];throw new u.a(i,Object(a.b)(s))}(t,e);throw new u.a(r,a.a.Unknown)}!function(t){t.ERROR="error",t.ERROR_CODE="error_code"}(n||(n={}))},function(t,e,r){"use strict";var n=function(){function t(){}return t.keyPresent=function(t,e){if(void 0===e[t])throw new Error("expected "+t+" to be present")},t}();e.a=n},,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return o}),r.d(e,"b",function(){return i});var n=r(170);function o(t){var e,r=t.length%4;0!=r?e=t+"=".repeat(4-r):e=t;var o=Object(n.toByteArray)(e);return function(t,e,r){var n="",o="";r=Math.min(t.length,r||1/0);for(var i=e=e||0;i<r;i++)t[i]<=127?(n+=u(o)+String.fromCharCode(t[i]),o=""):o+="%"+t[i].toString(16);return n+u(o)}(o,0,o.length)}function i(t){var e;return"undefined"==typeof Uint8Array&&(e=s(t)),e=new Uint8Array(s(t)),Object(n.fromByteArray)(e)}function s(t){for(var e,r=1/0,n=t.length,o=null,i=[],s=0;s<n;s++){if((e=t.charCodeAt(s))>55295&&e<57344){if(!o){if(e>56319){(r-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(r-=3)>-1&&i.push(239,191,189);continue}o=e;continue}if(e<56320){(r-=3)>-1&&i.push(239,191,189),o=e;continue}e=o-55296<<10|e-56320|65536,o=null}else o&&((r-=3)>-1&&i.push(239,191,189),o=null);if(e<128){if((r-=1)<0)break;i.push(e)}else if(e<2048){if((r-=2)<0)break;i.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;i.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<2097152))throw new Error("Invalid code point");if((r-=4)<0)break;i.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return i}function u(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}},function(t,e,r){"use strict";var n=function(){function t(){}return t.APPLICATION_JSON="application/json",t.TEXT_EVENT_STREAM="text/event-stream",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(t,e,r){void 0===e&&(e={}),void 0===r&&(r=[]),this.userType=t,this.data=e,this.identities=r}return t.empty=function(){return new t},Object.defineProperty(t.prototype,"name",{get:function(){return this.data.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"email",{get:function(){return this.data.email},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pictureUrl",{get:function(){return this.data.picture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstName",{get:function(){return this.data.first_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastName",{get:function(){return this.data.last_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gender",{get:function(){return this.data.gender},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"birthday",{get:function(){return this.data.birthday},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minAge",{get:function(){var t=this.data.min_age;if(void 0!==t)return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxAge",{get:function(){var t=this.data.max_age;if(void 0!==t)return t},enumerable:!0,configurable:!0}),t}();e.a=n},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e,r,n,o){this.method=t,this.path=e,this.headers=r,this.body=o,this.startedAt=n}return Object.defineProperty(t.prototype,"builder",{get:function(){return new t.Builder(this)},enumerable:!0,configurable:!0}),t}();!function(t){var e=function(){function e(t){void 0!==t&&(this.method=t.method,this.path=t.path,this.headers=t.headers,this.body=t.body,this.startedAt=t.startedAt)}return e.prototype.withMethod=function(t){return this.method=t,this},e.prototype.withPath=function(t){return this.path=t,this},e.prototype.withHeaders=function(t){return this.headers=t,this},e.prototype.withBody=function(t){return this.body=t,this},e.prototype.build=function(){if(void 0===this.method)throw Error("must set method");if(void 0===this.path)throw Error("must set non-empty path");return void 0===this.startedAt&&(this.startedAt=Date.now()/1e3),new t(this.method,this.path,void 0===this.headers?{}:this.headers,this.startedAt,this.body)},e}();t.Builder=e}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"c",function(){return o}),r.d(e,"d",function(){return i}),r.d(e,"b",function(){return s});var n="/api/client/v2.0";function o(t){return n+"/app/"+t}function i(t){return o(t)+"/functions/call"}function s(t){return o(t)+"/location"}},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var n,o=r(18),i=r(79),s=r(33),u=r(81),a=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){function e(e,r){var n=t.call(this,e.method,e.path,e.headers,e.startedAt,e.body)||this;return n.document=r,n}return a(e,t),Object.defineProperty(e.prototype,"builder",{get:function(){return new e.Builder(this)},enumerable:!0,configurable:!0}),e}(u.a);!function(t){var e=function(e){function r(t){var r=e.call(this,t)||this;return void 0!==t&&(r.document=t.document),r}return a(r,e),r.prototype.withDocument=function(t){return this.document=t,this},r.prototype.build=function(){if(void 0===this.document||!(this.document instanceof Object))throw new Error("document must be set");return void 0===this.headers&&this.withHeaders({}),this.headers[s.a.CONTENT_TYPE]=i.a.APPLICATION_JSON,this.withBody(o.a.stringify(this.document,{relaxed:!1})),new t(e.prototype.build.call(this),this.document)},r}(u.a.Builder);t.Builder=e}(c||(c={}))},,,,,,,,,function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="anon-user",t.DEFAULT_NAME="anon-user",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="api-key",t.DEFAULT_NAME="api-key",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="local-userpass",t.DEFAULT_NAME="local-userpass",t}();e.a=n},function(t,e,r){"use strict";r.d(e,"a",function(){return o}),r.d(e,"b",function(){return n});var n,o=function(){return function(){}}();!function(t){t[t.AUTH_EVENT=0]="AUTH_EVENT"}(n||(n={}))},,,,,,,,,,,function(t,e,r){"use strict";var n=function(){return function(t,e){this.id=t,this.providerType=e}}();e.a=n},,,function(t,e,r){"use strict";r.d(e,"a",function(){return c});var n,o=r(18),i=r(79),s=r(33),u=r(22),a=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){function e(e,r){var n=this;return(n=e instanceof u.a?t.call(this,e,e.useRefreshToken,e.shouldRefreshOnFailure)||this:t.call(this,e)||this).document=r,n}return a(e,t),Object.defineProperty(e.prototype,"builder",{get:function(){return new e.Builder(this)},enumerable:!0,configurable:!0}),e}(u.a);!function(t){var e=function(e){function r(t){var r=e.call(this,t)||this;return void 0!==t&&(r.document=t.document,r.useRefreshToken=t.useRefreshToken),r}return a(r,e),r.prototype.withDocument=function(t){return this.document=t,this},r.prototype.withAccessToken=function(){return this.useRefreshToken=!1,this},r.prototype.build=function(){if(void 0===this.document||!(this.document instanceof Object))throw new Error("document must be set: "+this.document);return void 0===this.headers&&this.withHeaders({}),this.headers[s.a.CONTENT_TYPE]=i.a.APPLICATION_JSON,this.withBody(o.a.stringify(this.document,{relaxed:!1})),new t(e.prototype.build.call(this),this.document)},r}(u.a.Builder);t.Builder=e}(c||(c={}))},function(t,e,r){"use strict";var n,o=r(18),i=r(57);!function(t){t.ID="_id",t.KEY="key",t.NAME="name",t.DISABLED="disabled"}(n||(n={}));var s=function(){function t(t,e,r,n){this.id=o.b.ObjectID.createFromHexString(t),this.key=e,this.name=r,this.disabled=n}return t.readFromApi=function(e){var r="string"==typeof e?JSON.parse(e):e;return i.a.keyPresent(n.ID,r),i.a.keyPresent(n.NAME,r),i.a.keyPresent(n.DISABLED,r),new t(r[n.ID],r[n.KEY],r[n.NAME],r[n.DISABLED])},t.prototype.toJSON=function(){var t;return(t={})[n.ID]=this.id,t[n.KEY]=this.key,t[n.NAME]=this.name,t[n.DISABLED]=this.disabled,t},t}();e.a=s},,,,,,,,,,,,function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="custom-token",t.DEFAULT_NAME="custom-token",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="oauth2-facebook",t.DEFAULT_NAME="oauth2-facebook",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="oauth2-google",t.DEFAULT_NAME="oauth2-google",t}();e.a=n},function(t,e,r){"use strict";var n=function(){function t(){}return t.TYPE="api-key",t.DEFAULT_NAME="api-key",t}();e.a=n},,,,function(t,e,r){"use strict";var n,o,i=r(106),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.ID="id",t.PROVIDER_TYPE="provider_type"}(o||(o={}));var u=function(t){function e(e,r){return t.call(this,e,r)||this}return s(e,t),e.decode=function(t){return new e(t[o.ID],t[o.PROVIDER_TYPE])},e.prototype.encode=function(){var t;return(t={})[o.ID]=this.id,t[o.PROVIDER_TYPE]=this.providerType,t},e}(i.a);e.a=u},,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(29),o=r(20),i=function(){function t(t,e){this.eventStream=t,this.decoder=e,this.listeners=[]}return t.prototype.next=function(){var t=this;return this.eventStream.nextEvent().then(function(e){var r=o.a.fromEvent(e,t.decoder);if(r.eventName===o.a.ERROR_EVENT_NAME)throw r.error;return r.eventName===n.a.MESSAGE_EVENT?r.data:t.next()})},t.prototype.onNext=function(t){var e=this,r={onEvent:function(r){var i=o.a.fromEvent(r,e.decoder);i.eventName===n.a.MESSAGE_EVENT&&t(i.data)}};this.eventStream.addListener(r)},t.prototype.onError=function(t){var e=this,r={onEvent:function(r){var n=o.a.fromEvent(r,e.decoder);n.eventName===o.a.ERROR_EVENT_NAME&&t(n.error)}};this.eventStream.addListener(r)},t.prototype.addListener=function(t){var e=this,r={onEvent:function(r){var n=o.a.fromEvent(r,e.decoder);n.eventName===o.a.ERROR_EVENT_NAME?t.onError&&t.onError(n.error):t.onNext&&t.onNext(n.data)}};this.listeners.push([t,r]),this.eventStream.addListener(r)},t.prototype.removeListener=function(t){for(var e=-1,r=0;r<this.listeners.length;r++)if(this.listeners[r][0]===t){e=r;break}if(-1!==e){var n=this.listeners[e][1];this.listeners.splice(e,1),this.eventStream.removeListener(n)}},t.prototype.isOpen=function(){return this.eventStream.isOpen()},t.prototype.close=function(){this.eventStream.close()},t}();e.a=i},function(t,e,r){"use strict";var n=function(){return function(t,e,r,n){this.authInfo=t,this.providerType=e,this.providerName=r,this.asLink=n}}();e.a=n},function(t,e,r){"use strict";var n,o,i=r(106),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.ID="id",t.PROVIDER_TYPE="provider_type"}(o||(o={}));var u=function(t){function e(e,r){return t.call(this,e,r)||this}return s(e,t),e.fromJSON=function(t){return new e(t[o.ID],t[o.PROVIDER_TYPE])},e.prototype.toJSON=function(){var t;return(t={})[o.ID]=this.id,t[o.PROVIDER_TYPE]=this.providerType,t},e}(i.a);e.a=u},function(t,e,r){"use strict";var n=r(18),o=r(42),i=r(78),s=r(11),u=r(109),a=r(22),c=r(95),h=function(){function t(t,e,r){this.serviceField="service",this.argumentsField="arguments",this.requestClient=t,this.serviceRoutes=e,this.serviceName=r,this.serviceBinders=[],this.allocatedStreams=[]}return t.prototype.callFunction=function(t,e,r){return this.requestClient.doAuthenticatedRequestWithDecoder(this.getCallServiceFunctionRequest(t,e),r)},t.prototype.streamFunction=function(t,e,r){var n=this;return this.requestClient.openAuthenticatedStreamWithDecoder(this.getStreamServiceFunctionRequest(t,e),r).then(function(t){return n.allocatedStreams.push(t),t})},t.prototype.bind=function(t){this.serviceBinders.push(t)},t.prototype.onRebindEvent=function(t){switch(t.type){case c.b.AUTH_EVENT:t.event.kind===o.a.ActiveUserChanged&&this.closeAllocatedStreams()}this.serviceBinders.forEach(function(e){e.onRebindEvent(t)})},t.prototype.getStreamServiceFunctionRequest=function(t,e){var r={name:t};void 0!==this.serviceName&&(r[this.serviceField]=this.serviceName),r[this.argumentsField]=e;var o=new a.a.Builder;return o.withMethod(s.a.GET).withPath(this.serviceRoutes.functionCallRoute+"?stitch_request="+encodeURIComponent(Object(i.b)(n.a.stringify(r)))),o.build()},t.prototype.getCallServiceFunctionRequest=function(t,e){var r={name:t};void 0!==this.serviceName&&(r[this.serviceField]=this.serviceName),r[this.argumentsField]=e;var n=new u.a.Builder;return n.withMethod(s.a.POST).withPath(this.serviceRoutes.functionCallRoute),n.withDocument(r),n.build()},t.prototype.closeAllocatedStreams=function(){this.allocatedStreams.forEach(function(t){t.isOpen()&&t.close()}),this.allocatedStreams=[]},t}();e.a=h},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){return function(t,e,r,n){this.method=t,this.url=e,this.headers=r,this.body=n}}();!function(t){var e=function(){function e(t){t&&(this.method=t.method,this.url=t.url,this.headers=t.headers,this.body=t.body)}return e.prototype.withMethod=function(t){return this.method=t,this},e.prototype.withUrl=function(t){return this.url=t,this},e.prototype.withHeaders=function(t){return this.headers=t,this},e.prototype.withBody=function(t){return this.body=t,this},e.prototype.build=function(){if(void 0===this.method)throw new Error("must set method");if(void 0===this.url)throw new Error("must set non-empty url");return new t(this.method,this.url,void 0===this.headers?{}:this.headers,this.body)},e}();t.Builder=e}(n||(n={}))},function(t,e,r){"use strict";var n=r(82);function o(t,e){return Object(n.c)(t)+"/auth/providers/"+e}function i(t,e){return o(t,e)+"/login"}var s=function(){function t(t){var e=this;this.baseAuthRoute=n.a+"/auth",this.sessionRoute=e.baseAuthRoute+"/session",this.profileRoute=e.baseAuthRoute+"/profile",this.clientAppId=t}return t.prototype.getAuthProviderRoute=function(t){return o(this.clientAppId,t)},t.prototype.getAuthProviderLoginRoute=function(t){return i(this.clientAppId,t)},t.prototype.getAuthProviderLinkRoute=function(t){return function(t,e){return i(t,e)+"?link=true"}(this.clientAppId,t)},t.prototype.getAuthProviderExtensionRoute=function(t,e){return this.getAuthProviderRoute(t)+"/"+e},t}();e.a=s},function(t,e,r){"use strict";var n=r(160),o=r(158),i=r(82),s=function(){return function(t){this.clientAppId=t,this.authRoutes=new o.a(t),this.serviceRoutes=new n.a(t),this.appMetadataRoute=Object(i.b)(t),this.functionCallRoute=Object(i.d)(t)}}();e.a=s},function(t,e,r){"use strict";var n=r(82),o=function(){return function(t){this.clientAppId=t,this.functionCallRoute=Object(n.d)(t)}}();e.a=o},,,,,,,,,,,function(t,e,r){"use strict";var n=r(78),o=function(){function t(t,e){this.expires=t,this.issuedAt=e}return t.fromEncoded=function(e){var r=t.splitToken(e),o=JSON.parse(Object(n.a)(r[1]));return new t(o.exp,o.iat)},t.splitToken=function(t){var e=t.split(".");if(3!==e.length)throw new Error("Malformed JWT token. The string "+t+" should have 3 parts.");return e},t}();e.a=o},function(t,e,r){"use strict";var n=function(){return function(t,e,r){this.providerName=t,this.requestClient=e,this.baseRoute=r}}();e.a=n},function(t,e,r){"use strict";var n=r(56),o=r(27),i=r(32),s=r(25),u=r(157);var a=function(){function t(t,e){this.baseUrl=t,this.transport=e}return t.prototype.doRequestToURL=function(t,e){return this.transport.roundTrip(this.buildRequest(t,e)).catch(function(t){throw new i.a(t,s.a.TRANSPORT_ERROR)}).then(function(t){return(e=t).statusCode>=200&&e.statusCode<300?e:Object(n.a)(e);var e})},t.prototype.doStreamRequestToURL=function(t,e,r,n){return void 0===r&&(r=!0),this.transport.stream(this.buildRequest(t,e),r,n).catch(function(t){if(t instanceof o.a)throw t;throw new i.a(t,s.a.TRANSPORT_ERROR)})},t.prototype.buildRequest=function(t,e){return(new u.a.Builder).withMethod(t.method).withUrl(""+e+t.path).withHeaders(t.headers).withBody(t.body).build()},t}();e.a=a},,,,,,,,,,function(t,e,r){"use strict";var n,o,i=r(80),s=r(129),u=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.DATA="data",t.USER_TYPE="type",t.IDENTITIES="identities"}(o||(o={}));var a=function(t){function e(e,r,n){var o=t.call(this,e,r,n)||this;return o.userType=e,o.data=r,o.identities=n,o}return u(e,t),e.decode=function(t){return t?new e(t[o.USER_TYPE],t[o.DATA],t[o.IDENTITIES].map(function(t){return s.a.decode(t)})):void 0},e.prototype.encode=function(){var t;return(t={})[o.DATA]=this.data,t[o.USER_TYPE]=this.userType,t[o.IDENTITIES]=this.identities.map(function(t){return t.encode()}),t},e}(i.a);e.a=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n,o,i=r(55),s=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.USER_ID="user_id",t.DEVICE_ID="device_id",t.ACCESS_TOKEN="access_token",t.REFRESH_TOKEN="refresh_token"}(o||(o={}));var u=function(t){function e(e,r,n,o){return t.call(this,e,r,n,o)||this}return s(e,t),e.fromJSON=function(t){return new e(t[o.USER_ID],t[o.DEVICE_ID],t[o.ACCESS_TOKEN],t[o.REFRESH_TOKEN])},e.prototype.toJSON=function(){var t;return(t={})[o.USER_ID]=this.userId,t[o.DEVICE_ID]=this.deviceId,t[o.ACCESS_TOKEN]=this.accessToken,t[o.REFRESH_TOKEN]=this.refreshToken,t},e}(i.a);e.a=u},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(){function t(t,e,r,n){this.baseUrl=t,this.storage=e,this.dataDirectory=r,this.transport=n}return t.prototype.builder=function(){return new t.Builder(this)},t}();!function(t){var e=function(){function e(t){t&&(this.baseUrl=t.baseUrl,this.storage=t.storage,this.dataDirectory=t.dataDirectory,this.transport=t.transport)}return e.prototype.withBaseUrl=function(t){return this.baseUrl=t,this},e.prototype.withStorage=function(t){return this.storage=t,this},e.prototype.withDataDirectory=function(t){return this.dataDirectory=t,this},e.prototype.withTransport=function(t){return this.transport=t,this},e.prototype.build=function(){return new t(this.baseUrl,this.storage,this.dataDirectory,this.transport)},e}();t.Builder=e}(n||(n={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(18),o=r(56),i=r(33),s=r(11),u=r(109),a=r(22),c=r(83),h=r(16),d=r(14),f=r(27),p=r(32),l=r(25),v=r(35),y=r(28),E=r(153),A=r(92),m=r(154),g=r(319),R=r(42),I=r(55),T=r(171),w=r(225),_=r(320),N=r(50),O=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},b=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},P=function(){function t(t,e,r,n){var o,i;void 0===n&&(n=!0),this.requestClient=t,this.authRoutes=e,this.storage=r;try{o=Object(N.b)(r)}catch(t){throw new h.a(d.a.CouldNotLoadPersistedAuthInfo)}this.allUsersAuthInfo=o;try{i=Object(N.a)(r)}catch(t){throw new h.a(d.a.CouldNotLoadPersistedAuthInfo)}this.activeUserAuthInfo=void 0===i?I.a.empty():i,this.activeUserAuthInfo.hasUser&&(this.currentUser=this.prepUser(this.activeUserAuthInfo)),n&&(this.accessTokenRefresher=new g.a(this),this.accessTokenRefresher.run())}return Object.defineProperty(t.prototype,"authInfo",{get:function(){return this.activeUserAuthInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoggedIn",{get:function(){return void 0!==this.currentUser&&this.currentUser.isLoggedIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return this.currentUser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasDeviceId",{get:function(){return void 0!==this.activeUserAuthInfo.deviceId&&""!==this.activeUserAuthInfo.deviceId&&"000000000000000000000000"!==this.activeUserAuthInfo.deviceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceId",{get:function(){if(this.hasDeviceId)return this.activeUserAuthInfo.deviceId},enumerable:!0,configurable:!0}),t.prototype.listUsers=function(){var t=this,e=[];return this.allUsersAuthInfo.forEach(function(r){e.push(t.prepUser(r))}),e},t.prototype.doAuthenticatedRequest=function(t,e){var r=this;try{return this.requestClient.doRequest(this.prepareAuthRequest(t,e||this.activeUserAuthInfo)).catch(function(e){return r.handleAuthFailure(e,t)})}catch(t){return Promise.reject(t)}},t.prototype.doAuthenticatedRequestWithDecoder=function(t,e){return this.doAuthenticatedRequest(t).then(function(t){var r=n.a.parse(t.body,{strict:!1});return e?e.decode(r):r}).catch(function(t){throw Object(o.b)(t)})},t.prototype.openAuthenticatedEventStream=function(t,e){var r=this;if(void 0===e&&(e=!0),!this.isLoggedIn)throw new h.a(d.a.MustAuthenticateFirst);var n=t.useRefreshToken?this.activeUserAuthInfo.refreshToken:this.activeUserAuthInfo.accessToken;return this.requestClient.doStreamRequest(t.builder.withPath(t.path+"&stitch_at="+n).build(),e,function(){return r.openAuthenticatedEventStream(t,!1)}).catch(function(n){return r.handleAuthFailureForEventStream(n,t,e)})},t.prototype.openAuthenticatedStreamWithDecoder=function(t,e){return this.openAuthenticatedEventStream(t).then(function(t){return new E.a(t,e)})},t.prototype.refreshAccessToken=function(){var t=this,e=(new a.a.Builder).withRefreshToken().withPath(this.authRoutes.sessionRoute).withMethod(s.a.POST);return this.doAuthenticatedRequest(e.build()).then(function(e){try{var r=w.a.fromJSON(JSON.parse(e.body));t.activeUserAuthInfo=t.activeUserAuthInfo.merge(r)}catch(t){throw new p.a(t,l.a.DECODING_ERROR)}try{Object(N.c)(t.activeUserAuthInfo,t.storage),t.allUsersAuthInfo.set(t.activeUserAuthInfo.userId,t.activeUserAuthInfo),Object(N.d)(t.allUsersAuthInfo,t.storage)}catch(t){throw new h.a(d.a.CouldNotPersistAuthInfo)}})},t.prototype.switchToUserWithId=function(t){var e=this.allUsersAuthInfo.get(t);if(void 0===e)throw new h.a(d.a.UserNotFound);if(!e.isLoggedIn)throw new h.a(d.a.UserNotLoggedIn);this.activeUserAuthInfo.hasUser&&this.allUsersAuthInfo.set(this.activeUserAuthInfo.userId,this.activeUserAuthInfo.withNewAuthActivityTime());var r=e.withNewAuthActivityTime();this.allUsersAuthInfo.set(t,r),Object(N.c)(r,this.storage),this.activeUserAuthInfo=r;var n=this.currentUser;return this.currentUser=this.prepUser(r),this.onAuthEvent(),this.dispatchAuthEvent({currentActiveUser:this.currentUser,kind:R.a.ActiveUserChanged,previousActiveUser:n}),this.currentUser},t.prototype.loginWithCredentialInternal=function(t){var e,r;if(t instanceof m.a)return this.processLogin(t,t.authInfo,t.asLink);if(t.providerCapabilities.reusesExistingSession)try{for(var n=O(this.allUsersAuthInfo),o=n.next();!o.done;o=n.next()){var i=b(o.value,2),s=i[0],u=i[1];if(u.loggedInProviderType===t.providerType){if(u.isLoggedIn)try{return Promise.resolve(this.switchToUserWithId(s))}catch(t){return Promise.reject(t)}void 0!==u.userId&&this.removeUserWithIdInternal(u.userId)}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this.doLogin(t,!1)},t.prototype.linkUserWithCredentialInternal=function(t,e){return void 0!==this.currentUser&&t.id!==this.currentUser.id?Promise.reject(new h.a(d.a.UserNoLongerValid)):this.doLogin(e,!0)},t.prototype.logoutInternal=function(){return this.isLoggedIn&&this.currentUser?this.logoutUserWithIdInternal(this.currentUser.id):Promise.resolve()},t.prototype.logoutUserWithIdInternal=function(t){var e=this,r=this.allUsersAuthInfo.get(t);if(void 0===r)return Promise.reject(new h.a(d.a.UserNotFound));if(!r.isLoggedIn)return Promise.resolve();var n=function(){e.clearUserAuthTokens(r.userId),r.loggedInProviderType===A.a.TYPE&&e.removeUserWithIdInternal(r.userId)};return this.doLogout(r).then(function(){n()}).catch(function(){n()})},t.prototype.removeUserInternal=function(){return this.isLoggedIn&&void 0!==this.currentUser?this.removeUserWithIdInternal(this.currentUser.id):Promise.resolve()},t.prototype.removeUserWithIdInternal=function(t){var e=this,r=this.allUsersAuthInfo.get(t);if(void 0===r)return Promise.reject(new h.a(d.a.UserNotFound));var n=function(){e.clearUserAuthTokens(r.userId),e.allUsersAuthInfo.delete(t),Object(N.d)(e.allUsersAuthInfo,e.storage);var n=e.prepUser(r.loggedOut());e.onAuthEvent(),e.dispatchAuthEvent({kind:R.a.UserRemoved,removedUser:n})};return r.isLoggedIn?this.doLogout(r).then(function(){n()}).catch(function(t){n()}):(n(),Promise.resolve())},t.prototype.close=function(){this.accessTokenRefresher&&this.accessTokenRefresher.stop()},t.prototype.prepareAuthRequest=function(t,e){if(!e.isLoggedIn)throw new h.a(d.a.MustAuthenticateFirst);var r=t.builder,n=r.headers||{};return t.useRefreshToken?n[i.a.AUTHORIZATION]=i.a.getAuthorizationBearer(e.refreshToken):n[i.a.AUTHORIZATION]=i.a.getAuthorizationBearer(e.accessToken),r.withHeaders(n),r.build()},t.prototype.handleAuthFailureForEventStream=function(t,e,r){var n=this;if(void 0===r&&(r=!0),!(t instanceof v.a)||t.errorCode!==y.a.InvalidSession)throw t;if(e.useRefreshToken||!e.shouldRefreshOnFailure)throw this.clearActiveUserAuth(),t;return this.tryRefreshAccessToken(e.startedAt).then(function(){return n.openAuthenticatedEventStream(e.builder.withShouldRefreshOnFailure(!1).build(),r)})},t.prototype.handleAuthFailure=function(t,e){var r=this;if(!(t instanceof v.a)||t.errorCode!==y.a.InvalidSession)throw t;if(e.useRefreshToken||!e.shouldRefreshOnFailure)throw this.clearActiveUserAuth(),t;return this.tryRefreshAccessToken(e.startedAt).then(function(){return r.doAuthenticatedRequest(e.builder.withShouldRefreshOnFailure(!1).build())})},t.prototype.tryRefreshAccessToken=function(t){if(!this.isLoggedIn)throw new h.a(d.a.LoggedOutDuringRequest);try{if(T.a.fromEncoded(this.activeUserAuthInfo.accessToken).issuedAt>=t)return Promise.resolve()}catch(t){}return this.refreshAccessToken()},t.prototype.prepUser=function(t){return this.userFactory.makeUser(t.userId,t.loggedInProviderType,t.loggedInProviderName,t.isLoggedIn,t.lastAuthActivity,t.userProfile)},t.prototype.attachAuthOptions=function(t){var e={};e.device=this.deviceInfo,t.options=e},t.prototype.doLogin=function(t,e){var r=this,n=this.currentUser;return this.doLoginRequest(t,e).then(function(n){return r.processLoginResponse(t,n,e)}).then(function(t){return r.onAuthEvent(),e?r.dispatchAuthEvent({kind:R.a.UserLinked,linkedUser:t}):(r.dispatchAuthEvent({kind:R.a.UserLoggedIn,loggedInUser:t}),r.dispatchAuthEvent({currentActiveUser:t,kind:R.a.ActiveUserChanged,previousActiveUser:n})),t})},t.prototype.doLoginRequest=function(t,e){var r=new c.a.Builder;r.withMethod(s.a.POST),e?r.withPath(this.authRoutes.getAuthProviderLinkRoute(t.providerName)):r.withPath(this.authRoutes.getAuthProviderLoginRoute(t.providerName));var n=t.material;if(this.attachAuthOptions(n),r.withDocument(n),!e)return this.requestClient.doRequest(r.build());var o=new u.a(r.build(),r.document);return this.doAuthenticatedRequest(o)},t.prototype.processLogin=function(t,e,r){var n=this,o=this.activeUserAuthInfo,i=this.currentUser;return e=this.activeUserAuthInfo.merge(new I.a(e.userId,e.deviceId,e.accessToken,e.refreshToken,t.providerType,t.providerName,void 0,void 0)),this.activeUserAuthInfo=e,this.currentUser=this.userFactory.makeUser(this.activeUserAuthInfo.userId,t.providerType,t.providerName,this.activeUserAuthInfo.isLoggedIn,new Date,void 0),this.doGetUserProfile().then(function(r){o.hasUser&&n.allUsersAuthInfo.set(o.userId,o.withNewAuthActivityTime()),e=e.merge(new I.a(e.userId,e.deviceId,e.accessToken,e.refreshToken,t.providerType,t.providerName,new Date,r));var s=!n.allUsersAuthInfo.has(e.userId);try{Object(N.c)(e,n.storage),n.allUsersAuthInfo.set(e.userId,e),Object(N.d)(n.allUsersAuthInfo,n.storage)}catch(t){throw n.activeUserAuthInfo=o,n.currentUser=i,e.userId!==o.userId&&e.userId&&n.allUsersAuthInfo.delete(e.userId),new h.a(d.a.CouldNotPersistAuthInfo)}return n.activeUserAuthInfo=e,n.currentUser=n.userFactory.makeUser(n.activeUserAuthInfo.userId,t.providerType,t.providerName,n.activeUserAuthInfo.isLoggedIn,n.activeUserAuthInfo.lastAuthActivity,r),s&&(n.onAuthEvent(),n.dispatchAuthEvent({addedUser:n.currentUser,kind:R.a.UserAdded})),n.currentUser}).catch(function(t){if(t instanceof h.a)throw t;if(r||o.hasUser){var e=n.activeUserAuthInfo;n.activeUserAuthInfo=o,n.currentUser=i,r&&(n.activeUserAuthInfo=n.activeUserAuthInfo.withAuthProvider(e.loggedInProviderType,e.loggedInProviderName))}else n.clearActiveUserAuth();throw t})},t.prototype.processLoginResponse=function(t,e,r){try{if(!e)throw new v.a("the login response could not be processed for credential: "+t+";response was undefined");if(!e.body)throw new v.a("response with status code "+e.statusCode+" has empty body");return this.processLogin(t,w.a.fromJSON(JSON.parse(e.body)),r)}catch(t){throw new p.a(t,l.a.DECODING_ERROR)}},t.prototype.doGetUserProfile=function(){var t=new a.a.Builder;return t.withMethod(s.a.GET).withPath(this.authRoutes.profileRoute),this.doAuthenticatedRequest(t.build()).then(function(t){return _.a.fromJSON(JSON.parse(t.body))}).catch(function(t){throw t instanceof f.a?t:new p.a(t,l.a.DECODING_ERROR)})},t.prototype.doLogout=function(t){var e=new a.a.Builder;return e.withRefreshToken().withPath(this.authRoutes.sessionRoute).withMethod(s.a.DELETE),this.doAuthenticatedRequest(e.build(),t).then(function(){})},t.prototype.clearActiveUserAuth=function(){this.isLoggedIn&&this.clearUserAuthTokens(this.activeUserAuthInfo.userId)},t.prototype.clearUserAuthTokens=function(t){var e=this.allUsersAuthInfo.get(t);if(void 0===e){if(this.activeUserAuthInfo.userId!==t)throw new h.a(d.a.UserNotFound)}else if(!e.isLoggedIn)return;try{var r=void 0;if(e){var n=e.loggedOut();this.allUsersAuthInfo.set(t,n),Object(N.d)(this.allUsersAuthInfo,this.storage),r=this.userFactory.makeUser(n.userId,n.loggedInProviderType,n.loggedInProviderName,n.isLoggedIn,n.lastAuthActivity,n.userProfile)}var o=!1;this.activeUserAuthInfo.hasUser&&this.activeUserAuthInfo.userId===t&&(o=!0,this.activeUserAuthInfo=this.activeUserAuthInfo.withClearedUser(),this.currentUser=void 0,Object(N.c)(this.activeUserAuthInfo,this.storage)),r&&(this.onAuthEvent(),this.dispatchAuthEvent({kind:R.a.UserLoggedOut,loggedOutUser:r}),o&&this.dispatchAuthEvent({currentActiveUser:void 0,kind:R.a.ActiveUserChanged,previousActiveUser:r}))}catch(t){throw new h.a(d.a.CouldNotPersistAuthInfo)}},t}();e.a=P},function(t,e,r){"use strict";var n=r(80),o=function(){function t(t,e,r,o,i,s){this.id=t,this.loggedInProviderType=e,this.loggedInProviderName=r,this.profile=void 0===s?n.a.empty():s,this.isLoggedIn=o,this.lastAuthActivity=i}return Object.defineProperty(t.prototype,"userType",{get:function(){return this.profile.userType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identities",{get:function(){return this.profile.identities},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){return this.id===t.id&&JSON.stringify(this.identities)===JSON.stringify(t.identities)&&this.isLoggedIn===t.isLoggedIn&&this.loggedInProviderName===t.loggedInProviderName&&this.loggedInProviderType===t.loggedInProviderType&&JSON.stringify(this.profile)===JSON.stringify(t.profile)},t}();e.a=o},function(t,e,r){"use strict";var n;!function(t){t.DEVICE_ID="deviceId",t.APP_ID="appId",t.APP_VERSION="appVersion",t.PLATFORM="platform",t.PLATFORM_VERSION="platformVersion",t.SDK_VERSION="sdkVersion"}(n||(n={})),e.a=n},function(t,e,r){"use strict";var n=r(34),o=r(92),i=function(){return function(t){void 0===t&&(t=o.a.DEFAULT_NAME),this.providerType=o.a.TYPE,this.material={},this.providerCapabilities=new n.a(!0),this.providerName=t}}();e.a=i},function(t,e,r){"use strict";var n,o=r(34),i=r(122);!function(t){t.TOKEN="token"}(n||(n={}))},function(t,e,r){"use strict";var n,o=r(34),i=r(123);!function(t){t.ACCESS_TOKEN="accessToken"}(n||(n={}));!function(){function t(t,e){var r;void 0===e&&(e=i.a.DEFAULT_NAME),this.providerType=i.a.TYPE,this.providerName=e,this.accessToken=t,this.material=((r={})[n.ACCESS_TOKEN]=this.accessToken,r)}Object.defineProperty(t.prototype,"providerCapabilities",{get:function(){return new o.a(!1)},enumerable:!0,configurable:!0})}()},function(t,e,r){"use strict";var n,o=r(34),i=r(124);!function(t){t.AUTH_CODE="authCode"}(n||(n={}))},function(t,e,r){"use strict";var n,o=r(34),i=r(125);!function(t){t.KEY="key"}(n||(n={}))},function(t,e,r){"use strict";var n,o,i=r(56),s=r(11),u=r(109),a=r(22),c=r(32),h=r(25),d=r(172),f=r(110),p=r(93),l=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.NAME="name"}(o||(o={}));var v=function(t){function e(e,r){var n=r.baseAuthRoute+"/api_keys",o=p.a.DEFAULT_NAME;return t.call(this,o,e,n)||this}return l(e,t),e.prototype.createApiKey=function(t){var e,r=new u.a.Builder;return r.withMethod(s.a.POST).withPath(this.baseRoute).withDocument((e={},e[o.NAME]=t,e)).withRefreshToken(),this.requestClient.doAuthenticatedRequest(r.build()).then(function(t){return f.a.readFromApi(t.body)}).catch(function(t){throw Object(i.b)(t)})},e.prototype.fetchApiKey=function(t){var e=new a.a.Builder;return e.withMethod(s.a.GET).withPath(this.getApiKeyRoute(t.toHexString())),e.withRefreshToken(),this.requestClient.doAuthenticatedRequest(e.build()).then(function(t){return f.a.readFromApi(t.body)}).catch(function(t){throw Object(i.b)(t)})},e.prototype.fetchApiKeys=function(){var t=new a.a.Builder;return t.withMethod(s.a.GET).withPath(this.baseRoute),t.withRefreshToken(),this.requestClient.doAuthenticatedRequest(t.build()).then(function(t){var e=JSON.parse(t.body);if(Array.isArray(e))return e.map(function(t){return f.a.readFromApi(t)});throw new c.a(new Error("unexpected non-array response from server"),h.a.DECODING_ERROR)}).catch(function(t){throw Object(i.b)(t)})},e.prototype.deleteApiKey=function(t){var e=new a.a.Builder;return e.withMethod(s.a.DELETE).withPath(this.getApiKeyRoute(t.toHexString())),e.withRefreshToken(),this.requestClient.doAuthenticatedRequest(e.build()).then(function(){})},e.prototype.enableApiKey=function(t){var e=new a.a.Builder;return e.withMethod(s.a.PUT).withPath(this.getApiKeyEnableRoute(t.toHexString())),e.withRefreshToken(),this.requestClient.doAuthenticatedRequest(e.build()).then(function(){})},e.prototype.disableApiKey=function(t){var e=new a.a.Builder;return e.withMethod(s.a.PUT).withPath(this.getApiKeyDisableRoute(t.toHexString())),e.withRefreshToken(),this.requestClient.doAuthenticatedRequest(e.build()).then(function(){})},e.prototype.getApiKeyRoute=function(t){return this.baseRoute+"/"+t},e.prototype.getApiKeyEnableRoute=function(t){return this.getApiKeyRoute(t)+"/enable"},e.prototype.getApiKeyDisableRoute=function(t){return this.getApiKeyRoute(t)+"/disable"},e}(d.a);e.a=v},function(t,e,r){"use strict";var n,o=r(34),i=r(93);!function(t){t.KEY="key"}(n||(n={}))},function(t,e,r){"use strict";var n,o,i,s=r(11),u=r(83),a=r(172),c=r(94),h=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.EMAIL="email",t.PASSWORD="password"}(o||(o={})),function(t){t.EMAIL="email",t.PASSWORD="password",t.TOKEN="token",t.TOKEN_ID="tokenId"}(i||(i={}));var d=function(t){function e(e,r,n){void 0===e&&(e=c.a.DEFAULT_NAME);var o=n.getAuthProviderRoute(e);return t.call(this,e,r,o)||this}return h(e,t),e.prototype.registerWithEmailInternal=function(t,e){var r,n=new u.a.Builder;return n.withMethod(s.a.POST).withPath(this.getRegisterWithEmailRoute()),n.withDocument(((r={})[o.EMAIL]=t,r[o.PASSWORD]=e,r)),this.requestClient.doRequest(n.build()).then(function(){})},e.prototype.confirmUserInternal=function(t,e){var r,n=new u.a.Builder;return n.withMethod(s.a.POST).withPath(this.getConfirmUserRoute()),n.withDocument(((r={})[i.TOKEN]=t,r[i.TOKEN_ID]=e,r)),this.requestClient.doRequest(n.build()).then(function(){})},e.prototype.resendConfirmationEmailInternal=function(t){var e,r=new u.a.Builder;return r.withMethod(s.a.POST).withPath(this.getResendConfirmationEmailRoute()),r.withDocument(((e={})[i.EMAIL]=t,e)),this.requestClient.doRequest(r.build()).then(function(){})},e.prototype.resetPasswordInternal=function(t,e,r){var n,o=new u.a.Builder;return o.withMethod(s.a.POST).withPath(this.getResetPasswordRoute()),o.withDocument(((n={})[i.TOKEN]=t,n[i.TOKEN_ID]=e,n[i.PASSWORD]=r,n)),this.requestClient.doRequest(o.build()).then(function(){})},e.prototype.sendResetPasswordEmailInternal=function(t){var e,r=new u.a.Builder;return r.withMethod(s.a.POST).withPath(this.getSendResetPasswordEmailRoute()),r.withDocument(((e={})[i.EMAIL]=t,e)),this.requestClient.doRequest(r.build()).then(function(){})},e.prototype.getRegisterWithEmailRoute=function(){return this.getExtensionRoute("register")},e.prototype.getConfirmUserRoute=function(){return this.getExtensionRoute("confirm")},e.prototype.getResendConfirmationEmailRoute=function(){return this.getExtensionRoute("confirm/send")},e.prototype.getResetPasswordRoute=function(){return this.getExtensionRoute("reset")},e.prototype.getSendResetPasswordEmailRoute=function(){return this.getExtensionRoute("reset/send")},e.prototype.getExtensionRoute=function(t){return this.baseRoute+"/"+t},e}(a.a);e.a=d},function(t,e,r){"use strict";var n,o=r(34),i=r(94);!function(t){t.USERNAME="username",t.PASSWORD="password"}(n||(n={}));var s=function(){return function(t,e,r){var s;void 0===r&&(r=i.a.DEFAULT_NAME),this.username=t,this.password=e,this.providerName=r,this.providerType=i.a.TYPE,this.providerCapabilities=new o.a(!1),this.material=((s={})[n.USERNAME]=this.username,s[n.PASSWORD]=this.password,s)}}();e.a=s},function(t,e,r){"use strict";var n;!function(t){t.Normal="normal",t.Server="server",t.Unknown="unknown"}(n||(n={}))},function(t,e,r){"use strict";!function(){function t(t){this.suiteName=t,this.storage={}}t.prototype.get=function(t){return this.storage[this.suiteName+"."+t]},t.prototype.set=function(t,e){this.storage[this.suiteName+"."+t]=e},t.prototype.remove=function(t){delete this.storage[this.suiteName+"."+t]}}()},function(t,e,r){"use strict";var n=r(156),o=function(){function t(t,e){this.functionService=new n.a(t,e.serviceRoutes)}return t.prototype.callFunction=function(t,e,r){return this.functionService.callFunction(t,e,r)},t}();e.a=o},function(t,e,r){"use strict";var n=r(27),o=r(32),i=r(29),s=r(20),u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},a=function(){function t(t){this.reconnecter=t,this.closed=!1,this.events=[],this.listeners=[],this.lastErr=void 0}return t.prototype.isOpen=function(){return!this.closed},t.prototype.addListener=function(t){var e=this;this.closed?setTimeout(function(){return t.onEvent(new i.a(s.a.ERROR_EVENT_NAME,"stream closed"))},0):void 0===this.lastErr?(this.listeners.push(t),this.poll()):setTimeout(function(){return t.onEvent(new i.a(s.a.ERROR_EVENT_NAME,e.lastErr))},0)},t.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)},t.prototype.nextEvent=function(){var t=this;return this.closed?Promise.reject(new i.a(s.a.ERROR_EVENT_NAME,"stream closed")):void 0!==this.lastErr?Promise.reject(new i.a(s.a.ERROR_EVENT_NAME,this.lastErr)):new Promise(function(e,r){t.listenOnce({onEvent:function(t){e(t)}})})},t.prototype.close=function(){this.closed||(this.closed=!0,this.afterClose())},t.prototype.reconnect=function(e){var r=this;this.reconnecter?this.reconnecter().then(function(t){r.onReconnect(t)}).catch(function(u){if(!(u instanceof n.a&&u instanceof o.a))return r.closed=!0,r.events.push(new i.a(s.a.ERROR_EVENT_NAME,"stream closed: "+e)),void r.poll();setTimeout(function(){return r.reconnect(u)},t.RETRY_TIMEOUT_MILLIS)}):this.closed||(this.closed=!0,this.events.push(new i.a(s.a.ERROR_EVENT_NAME,"stream closed: "+e)),this.poll())},t.prototype.poll=function(){for(var t,e;0!==this.events.length;){var r=this.events.pop();try{for(var n=u(this.listeners),o=n.next();!o.done;o=n.next()){var i=o.value;i.onEvent&&i.onEvent(r)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},t.prototype.listenOnce=function(t){var e=this;if(this.closed)setTimeout(function(){return t.onEvent(new i.a(s.a.ERROR_EVENT_NAME,"stream closed"))},0);else if(void 0===this.lastErr){var r={onEvent:function(n){e.removeListener(r),t.onEvent(n)}};this.addListener(r)}else setTimeout(function(){return t.onEvent(new i.a(s.a.ERROR_EVENT_NAME,e.lastErr))},0)},t.RETRY_TIMEOUT_MILLIS=5e3,t}();e.a=a},function(t,e,r){"use strict";var n=function(){return function(t,e,r){var n=this;this.statusCode=e,this.body=r,this.headers={},Object.keys(t).map(function(e,r){n.headers[e.toLocaleLowerCase()]=t[e]})}}();e.a=n},function(t,e,r){"use strict";var n,o=r(18),i=r(321),s=r(173),u=r(11),a=r(159),c=r(81),h=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),d=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},f=function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},p=function(t){function e(e,r,n){var o=t.call(this,r,n)||this;return o.clientAppId=e,o.routes=new a.a(e),o}return h(e,t),e.prototype.doRequest=function(e){var r=this;return this.initAppMetadata().then(function(n){return t.prototype.doRequestToURL.call(r,e,n.hostname)})},e.prototype.doStreamRequest=function(e,r,n){var o=this;return void 0===r&&(r=!0),this.initAppMetadata().then(function(i){return t.prototype.doStreamRequestToURL.call(o,e,i.hostname,r,n)})},e.prototype.getBaseURL=function(){return d(this,void 0,void 0,function(){return f(this,function(t){return[2,this.initAppMetadata().then(function(t){return t.hostname})]})})},e.prototype.initAppMetadata=function(){var e=this;if(this.appMetadata)return Promise.resolve(this.appMetadata);var r=(new c.a.Builder).withMethod(u.a.GET).withPath(this.routes.appMetadataRoute).build();return t.prototype.doRequestToURL.call(this,r,this.baseUrl).then(function(t){return e.appMetadata=i.a.fromJSON(o.a.parse(t.body)),e.appMetadata})},e}(s.a);e.a=p},function(t,e,r){"use strict";var n,o=r(173),i=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){function e(e,r){return t.call(this,e,r)||this}i(e,t),e.prototype.doRequest=function(e){return t.prototype.doRequestToURL.call(this,e,this.baseUrl)},e.prototype.doStreamRequest=function(e,r,n){return void 0===r&&(r=!0),t.prototype.doStreamRequestToURL.call(this,e,this.baseUrl,r,n)},e.prototype.getBaseURL=function(){return Promise.resolve(this.baseUrl)}}(o.a)},function(t,e,r){"use strict";var n,o=r(95),i=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e){var r=t.call(this)||this;return r.type=o.b.AUTH_EVENT,r.event=e,r}return i(e,t),e}(o.a);e.a=s},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var n,o=r(226),i=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r,n){var o=t.call(this,e.baseUrl,e.storage,e.dataDirectory,e.transport)||this;return o.localAppVersion=n,o.localAppName=r,o}return i(e,t),e.prototype.builder=function(){return new e.Builder(this)},e}(o.a);!function(t){var e=function(e){function r(t){var r=e.call(this,t)||this;return t&&(r.localAppVersion=t.localAppVersion,r.localAppName=t.localAppName),r}return i(r,e),r.prototype.withLocalAppName=function(t){return this.localAppName=t,this},r.prototype.withLocalAppVersion=function(t){return this.localAppVersion=t,this},r.prototype.build=function(){var r=e.prototype.build.call(this);return new t(r,this.localAppName,this.localAppVersion)},r}(o.a.Builder);t.Builder=e}(s||(s={}))},function(t,e,r){"use strict";var n=function(){return function(t,e,r,n){this.clientAppId=t,this.dataDirectory=e,this.localAppName=r,this.localAppVersion=n}}();e.a=n},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(171),o=function(){function t(t){this.auth=t}return t.prototype.shouldRefresh=function(){var t=this.auth;if(void 0===t)return!1;if(!t.isLoggedIn)return!1;var e,r=t.authInfo;if(void 0===r)return!1;if(!r.isLoggedIn)return!1;try{e=n.a.fromEncoded(r.accessToken)}catch(t){return console.log(t),!1}return!(Date.now()/1e3<e.expires-300)},t.prototype.run=function(){var t=this;this.shouldRefresh()?this.auth.refreshAccessToken().then(function(){t.nextTimeout=setTimeout(function(){return t.run()},6e4)}).catch(function(){t.nextTimeout=setTimeout(function(){return t.run()},6e4)}):this.nextTimeout=setTimeout(function(){return t.run()},6e4)},t.prototype.stop=function(){clearTimeout(this.nextTimeout)},t}();e.a=o},function(t,e,r){"use strict";var n,o,i=r(57),s=r(80),u=r(155),a=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t.DATA="data",t.USER_TYPE="type",t.IDENTITIES="identities"}(o||(o={}));var c=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return a(e,t),e.fromJSON=function(t){return i.a.keyPresent(o.USER_TYPE,t),i.a.keyPresent(o.DATA,t),i.a.keyPresent(o.IDENTITIES,t),new e(t[o.USER_TYPE],t[o.DATA],t[o.IDENTITIES].map(u.a.fromJSON))},e.prototype.toJSON=function(){var t;return(t={})[o.DATA]=this.data,t[o.USER_TYPE]=this.userType,t[o.IDENTITIES]=this.identities,t},e}(s.a);e.a=c},function(t,e,r){"use strict";var n;!function(t){t.DEPLOYMENT_MODEL="deployment_model",t.LOCATION="location",t.HOSTNAME="hostname"}(n||(n={}));var o=function(){function t(t,e,r){this.deploymentModel=t,this.location=e,this.hostname=r}return t.fromJSON=function(e){return new t(e[n.DEPLOYMENT_MODEL],e[n.LOCATION],e[n.HOSTNAME])},t.prototype.toJSON=function(){var t;return(t={})[n.DEPLOYMENT_MODEL]=this.deploymentModel,t[n.LOCATION]=this.location,t[n.HOSTNAME]=this.hostname,t},t}();e.a=o}]]);
//# sourceMappingURL=npm.mongodb-stitch-core-sdk.js.map